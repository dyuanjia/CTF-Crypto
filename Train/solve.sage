from sage.cpython.string import bytes_to_str
from Crypto.Util.number import long_to_bytes
n = 129332952599392613786704834268946868627517884344397916605982731951989157363336001748750227519221148515249462032425688314103449667152104218888749594343906300243773256628211680363995363839124123063398726587732153155373318591821933998316740919400951671751440572314631114600792840413114310459812036634755538239561

e = 3

m = "1ae080f08c8ccdca2138f537625cac02f40bc77cc1c8782c50f6133b58e6e2ab04e3733226488486666290c1320f073959addf0dbf562cb44234e35422ff6b33655588d68c4514dd6ff5928b7edaa5a58403d361f14ec0735500febb4eb3032fb2cdb3ea87e0eecbfac87792bdafe5fa01b192938ed8906d0f757e930bbfcdcd826b2c74c3d44d291f71bcaa998f9137276cdf89517bc02c5650e2d8361da98acdf3d5ed5de1f2bdd139cb0c43079cff61eb3d2d823484606845890ea49a8bb5543570f52409720967f23a805eafd0f628444da7df82c88636359098e56accc29a3e0921d5a422805aa3431e12f485be1dd4c31ff1ef3e6802267045ce624d37374b8cc0522968299361fa57a0c556a028ae2437fefefd4d3927448a0eca37907ca5673f2206959bc58448217c67404f5e41b082117be9c10d76af64f5f0ec15f2c6562604bd105020f9ac9e97776ad9e5b56b1bccb0dd56fbbdc43da1c7ea67e3f49e30ff03f7cf3dc3f614cf5cafa2807f79105849492771efe61da1f868b772856a42d1489c23f869c958cce6dfdf5c20f02be89651474bd20157fd777db76a3deb784f6da7e7bd87b26e2862b6fbddc35d3197abbbebb9acf7451cfeca6769b0149a40d6c760c7edc667ff261da3636b46c109be35dc817d5b3fe8c13beba7daf8b1ee1b1ad504e40a65e9e1c700c088c2caa85012deb24c3a299fe04f4655c59333ecf4db9fd08eaedeec16b768818869bf15440293e73b2ff7d4f80e8b280067abb12f20c1093a192ecf9b63c03a9e1f5344c68dad9faa8a1dd78b6a7d705fc96cc1f188952109fd7f5768cf51bfca514b2ab0691d1a77190baa93767d3349a9e7db0a65a3f5c175aeb36570bfbcbcc16abcb485533fdd58cd763c9e63"

m = [m[i:i+256] for i in range(0, len(m), 256)]

for i in range(len(m)):
    m[i] = int(m[i],16)


flag = ""
for i in range(len(m)-1):
    M = m[i]
    C = m[i+1]
    nbits = 1024
    kbits = 128
    mbar = M & (2^nbits-2^kbits)

    PR.<x> = PolynomialRing(Zmod(n))
    f = (mbar + x)^e - C

    x0 = f.small_roots(X=2^kbits, beta=1)[0]
    fl = long_to_bytes(int(mbar+x0)-int(M))
    flag += bytes_to_str(fl)

print(flag)